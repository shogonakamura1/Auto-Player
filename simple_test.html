<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ†ã‚¹ãƒˆ</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            background: #fafafa;
        }
        .file-input {
            width: 100%;
            padding: 15px;
            border: 2px dashed #007bff;
            border-radius: 8px;
            background: #f8f9fa;
            font-size: 16px;
            min-height: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .file-input:hover {
            border-color: #0056b3;
            background: #e7f3ff;
        }
        .file-input:focus {
            outline: none;
            border-color: #0056b3;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.25);
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
            font-weight: 500;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 14px;
        }
        .device-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-size: 12px;
            color: #6c757d;
        }
        .device-info p {
            margin: 5px 0;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            transition: background 0.3s ease;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button:active {
            transform: translateY(1px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“± ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="info">
            <strong>ãƒ†ã‚¹ãƒˆç›®çš„:</strong> ã‚¹ãƒãƒ›ã§ã®ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã¨WAVè­¦å‘Šæ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
        </div>
        
        <div class="test-section">
            <h3>ğŸµ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ†ã‚¹ãƒˆ</h3>
            <input type="file" class="file-input" id="audio-file" accept="audio/mp3,audio/mpeg,audio/aac,audio/ogg,audio/wav,audio/m4a,audio/wma,audio/flac,audio/webm">
            <div id="file-success" class="success"></div>
            <div id="wav-warning" class="warning">
                âš ï¸ <strong>WAVãƒ•ã‚¡ã‚¤ãƒ«è­¦å‘Š:</strong> ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ­£å¸¸ã«å‹•ä½œã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚MP3ãªã©ã®è»½é‡ãªå½¢å¼ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚
            </div>
        </div>
        
        <div class="test-section">
            <h3>ğŸµ ä»£æ›¿ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ†ã‚¹ãƒˆ</h3>
            <p style="font-size: 14px; color: #666;">ã‚‚ã—ä¸Šè¨˜ã§éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã§ããªã„å ´åˆã€ä»¥ä¸‹ã‚’è©¦ã—ã¦ãã ã•ã„ï¼š</p>
            
            <div style="margin: 10px 0;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">ãƒ†ã‚¹ãƒˆ1: å…¨ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼</label>
                <input type="file" class="file-input" id="all-files" accept="*/*">
            </div>
            
            <div style="margin: 10px 0;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">ãƒ†ã‚¹ãƒˆ2: æ‹¡å¼µå­ãƒ™ãƒ¼ã‚¹</label>
                <input type="file" class="file-input" id="extension-files" accept=".mp3,.m4a,.aac,.ogg,.wav,.flac,.wma">
            </div>
            
            <div style="margin: 10px 0;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">ãƒ†ã‚¹ãƒˆ3: åˆ¶é™ãªã—</label>
                <input type="file" class="file-input" id="no-restriction">
            </div>
            
            <div id="test-results-detail"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“‹ ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±</h3>
            <div id="device-info" class="device-info"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ§ª è¿½åŠ ãƒ†ã‚¹ãƒˆ</h3>
            <button class="test-button" onclick="testTouch()">ã‚¿ãƒƒãƒæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</button>
            <button class="test-button" onclick="testFileAPI()">ãƒ•ã‚¡ã‚¤ãƒ«APIãƒ†ã‚¹ãƒˆ</button>
            <button class="test-button" onclick="diagnoseFileSelection()">ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠè¨ºæ–­</button>
            <button class="test-button" onclick="clearResults()">çµæœã‚¯ãƒªã‚¢</button>
            <div id="test-results"></div>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’è¡¨ç¤º
        function showDeviceInfo() {
            const deviceInfo = document.getElementById('device-info');
            deviceInfo.innerHTML = `
                <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
                <p><strong>Platform:</strong> ${navigator.platform}</p>
                <p><strong>Language:</strong> ${navigator.language}</p>
                <p><strong>Screen Size:</strong> ${screen.width} x ${screen.height}</p>
                <p><strong>Viewport:</strong> ${window.innerWidth} x ${window.innerHeight}</p>
                <p><strong>Touch Support:</strong> ${('ontouchstart' in window) ? 'âœ… Yes' : 'âŒ No'}</p>
                <p><strong>Max Touch Points:</strong> ${navigator.maxTouchPoints || 'Unknown'}</p>
                <p><strong>Connection:</strong> ${navigator.connection ? navigator.connection.effectiveType : 'Unknown'}</p>
            `;
        }
        
        // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ†ã‚¹ãƒˆ
        const fileInput = document.getElementById('audio-file');
        const fileSuccess = document.getElementById('file-success');
        const wavWarning = document.getElementById('wav-warning');
        
        // è¤‡æ•°ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®å‡¦ç†
        const allFilesInput = document.getElementById('all-files');
        const extensionFilesInput = document.getElementById('extension-files');
        const noRestrictionInput = document.getElementById('no-restriction');
        const testResultsDetail = document.getElementById('test-results-detail');
        
        function handleFileSelection(file, inputType) {
            if (file) {
                const fileName = file.name.toLowerCase();
                const fileExtension = fileName.split('.').pop();
                
                const result = `
                    <div class="success" style="margin: 10px 0;">
                        <strong>âœ… ${inputType} - ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠæˆåŠŸ!</strong><br>
                        <strong>åå‰:</strong> ${file.name}<br>
                        <strong>ã‚¿ã‚¤ãƒ—:</strong> ${file.type || 'Unknown'}<br>
                        <strong>ã‚µã‚¤ã‚º:</strong> ${(file.size / 1024 / 1024).toFixed(2)} MB<br>
                        <strong>æ‹¡å¼µå­:</strong> .${fileExtension}<br>
                        <strong>MIME Type:</strong> ${file.type || 'Not detected'}
                    </div>
                `;
                
                // ãƒ¡ã‚¤ãƒ³ã®ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã®å ´åˆã®ã¿è­¦å‘Šã‚’è¡¨ç¤º
                if (inputType === 'ãƒ¡ã‚¤ãƒ³éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«') {
                    fileSuccess.innerHTML = result;
                    fileSuccess.style.display = 'block';
                    
                    // WAVãƒ•ã‚¡ã‚¤ãƒ«ã®è­¦å‘Š
                    if (fileExtension === 'wav' || file.type === 'audio/wav') {
                        wavWarning.style.display = 'block';
                    } else {
                        wavWarning.style.display = 'none';
                    }
                } else {
                    // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®çµæœã‚’è©³ç´°ã‚¨ãƒªã‚¢ã«è¡¨ç¤º
                    testResultsDetail.innerHTML += result;
                }
                
                console.log(`${inputType} - ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±:`, {
                    name: file.name,
                    type: file.type,
                    size: file.size,
                    extension: fileExtension
                });
            }
        }
        
        fileInput.addEventListener('change', function(e) {
            handleFileSelection(e.target.files[0], 'ãƒ¡ã‚¤ãƒ³éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«');
        });
        
        allFilesInput.addEventListener('change', function(e) {
            handleFileSelection(e.target.files[0], 'å…¨ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼');
        });
        
        extensionFilesInput.addEventListener('change', function(e) {
            handleFileSelection(e.target.files[0], 'æ‹¡å¼µå­ãƒ™ãƒ¼ã‚¹');
        });
        
        noRestrictionInput.addEventListener('change', function(e) {
            handleFileSelection(e.target.files[0], 'åˆ¶é™ãªã—');
        });
        
        // ã‚¿ãƒƒãƒæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
        function testTouch() {
            const results = document.getElementById('test-results');
            const touchSupported = 'ontouchstart' in window;
            const maxTouchPoints = navigator.maxTouchPoints || 0;
            
            results.innerHTML = `
                <div class="success">
                    <strong>ã‚¿ãƒƒãƒæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆçµæœ:</strong><br>
                    âœ… ã‚¿ãƒƒãƒã‚µãƒãƒ¼ãƒˆ: ${touchSupported ? 'Yes' : 'No'}<br>
                    âœ… æœ€å¤§ã‚¿ãƒƒãƒãƒã‚¤ãƒ³ãƒˆ: ${maxTouchPoints}<br>
                    âœ… ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆ: ${touchSupported ? 'åˆ©ç”¨å¯èƒ½' : 'åˆ©ç”¨ä¸å¯'}
                </div>
            `;
        }
        
        // ãƒ•ã‚¡ã‚¤ãƒ«APIãƒ†ã‚¹ãƒˆ
        function testFileAPI() {
            const results = document.getElementById('test-results');
            const fileAPISupported = 'File' in window && 'FileReader' in window;
            
            results.innerHTML = `
                <div class="success">
                    <strong>ãƒ•ã‚¡ã‚¤ãƒ«APIãƒ†ã‚¹ãƒˆçµæœ:</strong><br>
                    âœ… File API: ${fileAPISupported ? 'ã‚µãƒãƒ¼ãƒˆæ¸ˆã¿' : 'æœªã‚µãƒãƒ¼ãƒˆ'}<br>
                    âœ… FileReader: ${'FileReader' in window ? 'ã‚µãƒãƒ¼ãƒˆæ¸ˆã¿' : 'æœªã‚µãƒãƒ¼ãƒˆ'}<br>
                    âœ… FileList: ${'FileList' in window ? 'ã‚µãƒãƒ¼ãƒˆæ¸ˆã¿' : 'æœªã‚µãƒãƒ¼ãƒˆ'}
                </div>
            `;
        }
        
        // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠè¨ºæ–­
        function diagnoseFileSelection() {
            const results = document.getElementById('test-results');
            const acceptAttributes = [
                { name: 'audio/*', value: 'audio/*' },
                { name: 'audio/mp3,audio/mpeg', value: 'audio/mp3,audio/mpeg' },
                { name: '.mp3,.m4a,.aac', value: '.mp3,.m4a,.aac' },
                { name: 'åˆ¶é™ãªã—', value: '' }
            ];
            
            let diagnosis = '<div class="info"><strong>ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠè¨ºæ–­çµæœ:</strong><br>';
            
            // ãƒ–ãƒ©ã‚¦ã‚¶æƒ…å ±
            diagnosis += `<strong>ãƒ–ãƒ©ã‚¦ã‚¶:</strong> ${navigator.userAgent}<br>`;
            diagnosis += `<strong>ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ :</strong> ${navigator.platform}<br>`;
            
            // acceptå±æ€§ã®ãƒ†ã‚¹ãƒˆ
            diagnosis += '<br><strong>Acceptå±æ€§ã®æ¨å¥¨è¨­å®š:</strong><br>';
            acceptAttributes.forEach(attr => {
                diagnosis += `â€¢ ${attr.name}: ${attr.value}<br>`;
            });
            
            // ãƒ¢ãƒã‚¤ãƒ«ç‰¹æœ‰ã®åˆ¶é™
            if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                diagnosis += '<br><strong>ãƒ¢ãƒã‚¤ãƒ«ç‰¹æœ‰ã®åˆ¶é™:</strong><br>';
                diagnosis += 'â€¢ iOS Safari: ä¸€éƒ¨ã®éŸ³å£°å½¢å¼ãŒåˆ¶é™ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™<br>';
                diagnosis += 'â€¢ Android Chrome: ã‚ˆã‚Šå¤šãã®å½¢å¼ã‚’ã‚µãƒãƒ¼ãƒˆ<br>';
                diagnosis += 'â€¢ ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã¯OSã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™<br>';
            }
            
            diagnosis += '</div>';
            results.innerHTML = diagnosis;
        }
        
        // çµæœã‚¯ãƒªã‚¢
        function clearResults() {
            document.getElementById('test-results').innerHTML = '';
            document.getElementById('test-results-detail').innerHTML = '';
            document.getElementById('file-success').style.display = 'none';
            document.getElementById('wav-warning').style.display = 'none';
            
            // ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('audio-file').value = '';
            document.getElementById('all-files').value = '';
            document.getElementById('extension-files').value = '';
            document.getElementById('no-restriction').value = '';
        }
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            showDeviceInfo();
            
            // ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ã®ãƒ©ãƒ™ãƒ«ã‚’æ”¹å–„
            fileInput.addEventListener('click', function() {
                console.log('ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ');
            });
            
            // ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆ
            if ('ontouchstart' in window) {
                fileInput.addEventListener('touchstart', function() {
                    console.log('ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ');
                });
            }
        });
    </script>
</body>
</html> 